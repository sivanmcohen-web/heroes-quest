<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>×”×§×•×•×¡×˜ ×©×œ ××©×¤×—×ª ×›×”×Ÿ</title>
<link href="https://fonts.googleapis.com/css2?family=Titan+One&family=Nunito:wght@700;900&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{
--noam:#10b981;--omer:#a855f7;--yuval:#ec4899;--gold:#fbbf24;
--bg-dark:#0f172a;--bg-darker:#020617;
}
body{
font-family:'Nunito',sans-serif;
min-height:100vh;
background:radial-gradient(ellipse at top,#1e1b4b,#0f172a),linear-gradient(135deg,#1e293b 0%,#0f172a 100%);
color:#fff;
overflow-x:hidden;
position:relative;
}
body::before{
content:'';
position:fixed;
top:0;left:0;right:0;bottom:0;
background:
radial-gradient(circle at 20% 30%,rgba(16,185,129,0.15),transparent 40%),
radial-gradient(circle at 80% 70%,rgba(168,85,247,0.15),transparent 40%),
radial-gradient(circle at 50% 50%,rgba(236,72,153,0.1),transparent 50%);
pointer-events:none;
animation:bgFloat 20s ease-in-out infinite;
}
@keyframes bgFloat{0%,100%{transform:translateY(0) scale(1)}50%{transform:translateY(-20px) scale(1.05)}}
.stars{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:0}
.star{position:absolute;width:2px;height:2px;background:#fff;border-radius:50%;animation:twinkle 3s ease-in-out infinite}
@keyframes twinkle{0%,100%{opacity:0.3;transform:scale(1)}50%{opacity:1;transform:scale(1.5)}}
.particles{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:0}
.particle{position:absolute;width:4px;height:4px;background:var(--gold);border-radius:50%;animation:particleFloat 15s infinite;opacity:0}
@keyframes particleFloat{0%{transform:translateY(100vh) translateX(0) scale(0);opacity:0}10%{opacity:1}90%{opacity:1}100%{transform:translateY(-100vh) translateX(100px) scale(1);opacity:0}}
.screen{display:none;padding:20px;position:relative;z-index:1}
.screen.active{display:block;animation:screenFade 0.6s cubic-bezier(0.165,0.84,0.44,1)}
@keyframes screenFade{from{opacity:0;transform:translateY(30px) scale(0.95)}to{opacity:1;transform:translateY(0) scale(1)}}
.container{max-width:900px;margin:0 auto}
.card{
background:linear-gradient(135deg,rgba(30,41,59,0.95),rgba(15,23,42,0.95));
backdrop-filter:blur(30px);
border-radius:30px;
padding:50px 40px;
border:2px solid rgba(255,255,255,0.1);
box-shadow:0 30px 90px rgba(0,0,0,0.5),inset 0 1px 0 rgba(255,255,255,0.1);
position:relative;
overflow:hidden;
margin-bottom:30px;
z-index:1;
}
.card::before{
content:'';
position:absolute;
top:-50%;left:-50%;
width:200%;height:200%;
background:radial-gradient(circle,rgba(255,255,255,0.05),transparent 60%);
animation:cardShine 8s linear infinite;
pointer-events:none;
z-index:0;
}
@keyframes cardShine{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
h1{
font-family:'Titan One',cursive;
font-size:3rem;
text-align:center;
margin-bottom:30px;
background:linear-gradient(135deg,#fbbf24,#fef3c7,#fbbf24);
-webkit-background-clip:text;
-webkit-text-fill-color:transparent;
background-clip:text;
text-shadow:0 0 60px rgba(251,191,36,0.5);
animation:titlePulse 3s ease-in-out infinite;
letter-spacing:2px;
position:relative;
z-index:1;
}
@keyframes titlePulse{0%,100%{filter:brightness(1) drop-shadow(0 0 20px rgba(251,191,36,0.6))}50%{filter:brightness(1.3) drop-shadow(0 0 40px rgba(251,191,36,0.8))}}
h2{font-family:'Titan One',cursive;font-size:2rem;text-align:center;margin-bottom:20px;color:var(--gold);position:relative;z-index:5}
.hero-emoji{
font-size:9rem;
text-align:center;
margin:30px 0;
animation:heroFloat 4s ease-in-out infinite;
filter:drop-shadow(0 20px 40px rgba(0,0,0,0.6));
position:relative;
z-index:1;
}
@keyframes heroFloat{0%,100%{transform:translateY(0) rotate(-5deg)}50%{transform:translateY(-40px) rotate(5deg)}}
p{text-align:center;font-size:1.3rem;line-height:1.8;margin-bottom:25px;font-weight:700;text-shadow:0 2px 10px rgba(0,0,0,0.5);position:relative;z-index:5}
input[type="tel"],input[type="file"]{
width:100%;
padding:25px;
font-size:1.7rem;
border:3px solid transparent;
border-radius:20px;
background:linear-gradient(135deg,rgba(255,255,255,0.1),rgba(255,255,255,0.05));
color:#fff;
text-align:center;
font-weight:900;
margin-bottom:30px;
font-family:'Nunito',sans-serif;
transition:all 0.4s cubic-bezier(0.175,0.885,0.32,1.275);
position:relative;
z-index:1;
letter-spacing:3px;
}
input:focus{
outline:none;
border-color:var(--gold);
background:rgba(255,255,255,0.15);
box-shadow:0 0 40px rgba(251,191,36,0.6),inset 0 2px 10px rgba(0,0,0,0.3);
transform:scale(1.05);
}
input::placeholder{color:rgba(255,255,255,0.5)}
.btn{
width:100%;
padding:25px;
font-size:1.6rem;
font-weight:900;
background:linear-gradient(135deg,#fbbf24 0%,#f59e0b 50%,#fbbf24 100%);
background-size:200% 100%;
color:#0f172a;
border:none;
border-radius:25px;
cursor:pointer;
box-shadow:0 20px 50px rgba(251,191,36,0.5),inset 0 2px 0 rgba(255,255,255,0.3),inset 0 -2px 10px rgba(0,0,0,0.2);
margin:15px 0;
font-family:'Nunito',sans-serif;
transition:all 0.3s cubic-bezier(0.175,0.885,0.32,1.275);
position:relative;
overflow:hidden;
z-index:1;
text-transform:uppercase;
letter-spacing:2px;
}
.btn::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,0.3),transparent);transition:left 0.5s}
.btn:hover::before{left:100%}
.btn:active{transform:translateY(-5px) scale(0.98);box-shadow:0 25px 60px rgba(251,191,36,0.7),inset 0 2px 0 rgba(255,255,255,0.5);background-position:100% 0}
.btn-secondary{background:linear-gradient(135deg,rgba(255,255,255,0.15),rgba(255,255,255,0.05));color:#fff;border:2px solid rgba(255,255,255,0.3);box-shadow:0 10px 30px rgba(0,0,0,0.3);position:relative;z-index:10}
.btn-secondary:active{background:rgba(255,255,255,0.2);transform:translateY(-3px)}
.avatar-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(130px,1fr));gap:20px;margin:40px 0;position:relative;z-index:1}
.avatar-option{
aspect-ratio:1;
background:linear-gradient(135deg,rgba(30,41,59,0.8),rgba(15,23,42,0.8));
border:3px solid rgba(255,255,255,0.15);
border-radius:25px;
display:flex;
flex-direction:column;
align-items:center;
justify-content:center;
cursor:pointer;
transition:all 0.4s cubic-bezier(0.175,0.885,0.32,1.275);
position:relative;
overflow:hidden;
}
.avatar-option::before{content:'';position:absolute;inset:-100%;background:conic-gradient(from 0deg,transparent,var(--gold),transparent 30%);animation:avatarRotate 4s linear infinite;opacity:0;transition:opacity 0.3s}
.avatar-option:hover::before{opacity:0.3}
@keyframes avatarRotate{to{transform:rotate(360deg)}}
.avatar-option:hover{transform:translateY(-15px) scale(1.1);border-color:var(--gold);box-shadow:0 30px 60px rgba(251,191,36,0.4)}
.avatar-option.selected{border-color:var(--gold);border-width:4px;background:linear-gradient(135deg,rgba(251,191,36,0.2),rgba(245,158,11,0.2));box-shadow:0 20px 50px rgba(251,191,36,0.6),inset 0 0 30px rgba(251,191,36,0.2)}
.avatar-option.selected::after{content:'âœ“';position:absolute;top:8px;right:8px;background:var(--gold);color:#0f172a;width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:900;font-size:1.2rem;animation:checkPop 0.4s cubic-bezier(0.175,0.885,0.32,1.275)}
@keyframes checkPop{from{transform:scale(0) rotate(-180deg)}to{transform:scale(1) rotate(0deg)}}
.avatar-emoji{font-size:4.5rem;margin-bottom:10px;filter:drop-shadow(0 10px 20px rgba(0,0,0,0.4));transition:transform 0.3s}
.avatar-option:hover .avatar-emoji{transform:scale(1.2) rotate(10deg)}
.avatar-name{font-weight:800;font-size:1rem;text-align:center}
.user-header{text-align:center;margin-bottom:40px;position:relative;z-index:1}
.user-avatar{
width:140px;height:140px;
border-radius:50%;
display:inline-flex;
align-items:center;
justify-content:center;
font-size:6.5rem;
border:6px solid;
box-shadow:0 20px 60px rgba(0,0,0,0.5);
position:relative;
animation:avatarGlow 3s ease-in-out infinite;
margin-bottom:20px;
}
@keyframes avatarGlow{0%,100%{box-shadow:0 20px 60px currentColor,0 0 60px currentColor}50%{box-shadow:0 25px 70px currentColor,0 0 80px currentColor}}
.user-avatar::before{content:'';position:absolute;inset:-10px;border-radius:50%;background:conic-gradient(from 0deg,transparent,currentColor,transparent 50%);animation:avatarSpin 3s linear infinite;opacity:0.3}
@keyframes avatarSpin{to{transform:rotate(360deg)}}
.points-mega{
background:linear-gradient(135deg,rgba(251,191,36,0.2),rgba(245,158,11,0.2));
border:4px solid var(--gold);
border-radius:30px;
padding:35px;
text-align:center;
margin:30px 0;
position:relative;
overflow:hidden;
box-shadow:0 20px 50px rgba(251,191,36,0.3);
}
.points-mega::before{content:'';position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:conic-gradient(from 0deg,transparent,rgba(251,191,36,0.3),transparent 30%);animation:pointsSpin 6s linear infinite}
@keyframes pointsSpin{to{transform:rotate(360deg)}}
.points-number{
font-size:5.5rem;
font-weight:900;
font-family:'Titan One',cursive;
background:linear-gradient(135deg,#fbbf24,#fef3c7);
-webkit-background-clip:text;
-webkit-text-fill-color:transparent;
background-clip:text;
position:relative;
z-index:1;
animation:pointsFloat 2s ease-in-out infinite;
}
@keyframes pointsFloat{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
.mission{
background:linear-gradient(135deg,rgba(30,41,59,0.9),rgba(15,23,42,0.9));
border-radius:25px;
padding:30px;
margin:20px 0;
border:3px solid rgba(255,255,255,0.1);
position:relative;
overflow:hidden;
transition:all 0.4s cubic-bezier(0.175,0.885,0.32,1.275);
}
.mission::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,0.1),transparent)}
.mission:hover{transform:translateX(-10px);border-color:rgba(251,191,36,0.5);box-shadow:0 20px 50px rgba(0,0,0,0.4)}
.mission:hover::before{left:100%;transition:left 0.7s}
.mission-icon{font-size:3.5rem;margin-bottom:15px;display:inline-block;animation:missionBounce 2s ease-in-out infinite}
@keyframes missionBounce{0%,100%{transform:translateY(0) rotate(0deg)}50%{transform:translateY(-10px) rotate(5deg)}}
.mission-title{font-size:1.7rem;font-weight:900;margin-bottom:10px;color:var(--gold)}
.mission.completed{opacity:0.6;border-color:#10b981;background:linear-gradient(135deg,rgba(16,185,129,0.2),rgba(5,150,105,0.1))}
.mission.completed::after{content:'âœ“';position:absolute;top:20px;right:20px;font-size:2.5rem;color:#10b981;font-weight:900;animation:checkBounce 0.6s cubic-bezier(0.175,0.885,0.32,1.275)}
@keyframes checkBounce{0%{transform:scale(0) rotate(-180deg)}60%{transform:scale(1.2) rotate(10deg)}100%{transform:scale(1) rotate(0deg)}}
.progress-bar{background:rgba(0,0,0,0.3);height:25px;border-radius:12px;overflow:hidden;margin:20px 0;position:relative;z-index:1}
.progress-fill{height:100%;background:linear-gradient(90deg,#10b981,#059669);transition:width 0.5s;display:flex;align-items:center;justify-content:center;font-size:0.95rem;font-weight:900}
.question{font-size:2.6rem;color:var(--gold);font-weight:900;text-align:center;margin:25px 0;text-shadow:0 3px 10px rgba(0,0,0,0.5);position:relative;z-index:1}
.answers{display:grid;grid-template-columns:1fr 1fr;gap:18px;max-width:550px;margin:0 auto;position:relative;z-index:1}
.answer{
background:rgba(255,255,255,0.1);
border:3px solid rgba(255,255,255,0.3);
padding:25px;
border-radius:18px;
font-size:1.7rem;
font-weight:800;
cursor:pointer;
text-align:center;
transition:all 0.3s;
}
.answer:active{transform:scale(0.95)}
.answer.correct{background:linear-gradient(135deg,#10b981,#059669);border-color:#10b981}
.answer.wrong{background:linear-gradient(135deg,#ef4444,#dc2626);border-color:#ef4444}
.feedback{text-align:center;font-size:1.3rem;font-weight:700;margin:20px 0;min-height:50px;position:relative;z-index:1}
.upload-area{
border:3px dashed rgba(255,255,255,0.4);
border-radius:20px;
padding:40px;
text-align:center;
cursor:pointer;
transition:all 0.3s;
margin:20px 0;
position:relative;
z-index:5;
background:rgba(255,255,255,0.05);
}
.upload-area:hover{background:rgba(255,255,255,0.1);border-color:var(--gold)}
.upload-area.uploaded{border-color:#10b981;background:rgba(16,185,129,0.1)}
.preview-img{max-width:100%;border-radius:15px;margin-top:20px;box-shadow:0 10px 30px rgba(0,0,0,0.5);position:relative;z-index:1}
.report-section{background:rgba(30,41,59,0.8);border-radius:15px;padding:20px;margin:15px 0;border:2px solid rgba(255,255,255,0.1);position:relative;z-index:1}
.skill-item{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid rgba(255,255,255,0.1)}
.skill-item:last-child{border-bottom:none}
.skill-score{padding:6px 14px;border-radius:10px;font-weight:900;font-size:1rem}
.score-excellent{background:#10b981}
.score-good{background:#fbbf24;color:#0f172a}
.score-needs-work{background:#ef4444}
.reward-list{background:rgba(0,0,0,0.2);border-radius:15px;padding:20px;margin:15px 0;position:relative;z-index:1}
.reward-item{padding:12px;margin:8px 0;background:rgba(255,255,255,0.1);border-radius:10px;font-size:1.1rem}
@media(max-width:768px){
h1{font-size:2.3rem}
.hero-emoji{font-size:6rem}
.avatar-grid{grid-template-columns:repeat(3,1fr);gap:15px}
.avatar-emoji{font-size:3.5rem}
.points-number{font-size:4rem}
.answers{grid-template-columns:1fr}
}
</style>
</head>
<body>
<div class="stars" id="starsContainer"></div>
<div class="particles" id="particlesContainer"></div>

<!-- Login -->
<div id="login" class="screen active">
<div class="container">
<div class="card">
<div class="hero-emoji">ğŸ®</div>
<h1>×”×§×•×•×¡×˜ ×©×œ ××©×¤×—×ª ×›×”×Ÿ</h1>
<p>âœ¨ ×‘×¨×•×›×™× ×”×‘××™× ×œ××¡×¢ ×”×§×¡×•×! âœ¨</p>
<input type="tel" id="phoneInput" placeholder="×”×§×œ×“ ××ª ×”××¡×¤×¨ ×©×œ×š">
<button class="btn" onclick="login()">ğŸš€ ×”×ª×—×œ ×”×¨×¤×ª×§×”!</button>
<button class="btn-secondary" onclick="showParentDash()" style="margin-top:20px">ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ ×›× ×™×¡×ª ×”×•×¨×”</button>
<div id="loginError" style="color:#ef4444;text-align:center;margin-top:15px;font-weight:800;display:none">âŒ ×”××¡×¤×¨ ×œ× × ×›×•×Ÿ!</div>
<p style="font-size:1rem;opacity:0.7;margin-top:25px">
× ×•×¢×: 0559907670 | ×¢×•××¨: 0559957502 | ×™×•×‘×œ: 0529928161
</p>
</div>
</div>
</div>

<!-- Avatar Selection -->
<div id="avatarSelect" class="screen">
<div class="container">
<div class="card">
<h1>×‘×—×¨ ××ª ×”×“××•×ª ×©×œ×š!</h1>
<p>ğŸ­ ××™ ×ª×¨×¦×” ×œ×”×™×•×ª ×‘××¡×¢? ×‘×—×¨ ××ª ×”×“××•×ª ×©××“×‘×¨×ª ××œ×™×š!</p>
<div class="avatar-grid" id="avatarGrid"></div>
<button class="btn" id="confirmAvatar" style="display:none" onclick="confirmAvatar()">âœ¨ ×”×ª×—×œ ×¢× ×”×“××•×ª ×©×œ×™!</button>
</div>
</div>
</div>

<!-- Diagnostic Intro -->
<div id="diagIntro" class="screen">
<div class="container">
<div class="card">
<div class="user-avatar" id="diagAvatar" style="border-color:var(--gold)"></div>
<h1 id="diagName"></h1>
<p id="diagText"></p>
<button class="btn" onclick="startDiag()">ğŸ’ª ×‘×•××• × ×ª×—×™×œ!</button>
</div>
</div>
</div>

<!-- Diagnostic Test -->
<div id="diagTest" class="screen">
<div class="container">
<div class="card">
<div class="progress-bar">
<div class="progress-fill" id="diagProgress">0%</div>
</div>
<div id="diagContent"></div>
</div>
</div>
</div>

<!-- Diagnostic Report -->
<div id="diagReport" class="screen">
<div class="container">
<div class="card">
<div class="hero-emoji">ğŸ†</div>
<h1>×¡×™×™××ª ××ª ×”××‘×“×§!</h1>
<div id="reportContent"></div>
<button class="btn" onclick="gotoDash()">ğŸ® ×‘×•××• ×œ×©×—×§!</button>
</div>
</div>
</div>

<!-- Dashboard -->
<div id="dashboard" class="screen">
<div class="container">
<div class="card">
<div class="user-header">
<div class="user-avatar" id="dashAvatar"></div>
<h1 id="dashName"></h1>
</div>
<div class="points-mega">
<div class="points-number" id="dashPoints">0</div>
<p style="font-size:1.4rem;font-weight:900;position:relative;z-index:1">â­ ×›×•×›×‘×™× ×§×¡×•××™×</p>
</div>
</div>
<div class="card">
<h2 style="font-size:2.2rem">ğŸ“‹ ×”××©×™××•×ª ×©×œ×š</h2>
<div id="missionsContainer"></div>
</div>
<div class="card" style="text-align:center">
<button class="btn" onclick="showCards()">ğŸ“¸ ×›×¨×˜×™×¡×™×™×ª ×”×—×ª×™××•×ª</button>
<button class="btn" onclick="showRewards()">ğŸ ×”×¤×¨×¡×™× ×”××“×”×™××™×</button>
<button class="btn" id="practiceBtn" style="display:none" onclick="showPractice()">â­ ×ª×¨×’×•×œ ××™×•×—×“</button>
<button class="btn-secondary" onclick="logout()" style="margin-top:20px">ğŸšª ×”×ª× ×ª×§</button>
</div>
</div>
</div>

<!-- Mission Upload -->
<div id="uploadMission" class="screen">
<div class="container">
<div class="card">
<button class="btn-secondary" onclick="backFromUpload()">â† ×—×–×•×¨</button>
<h2 id="uploadTitle"></h2>
<p id="uploadDesc"></p>
<div class="upload-area" id="uploadArea" onclick="document.getElementById('missionFile').click()">
<div style="font-size:5rem;margin-bottom:15px">ğŸ“¸</div>
<div style="font-size:1.3rem;font-weight:700">×œ×—×¥ ×›××Ÿ ×œ×”×¢×œ×•×ª ×¦×™×œ×•× ××¡×š</div>
<input type="file" id="missionFile" style="display:none" accept="image/*" onchange="previewMission(event)">
</div>
<img id="missionPreview" class="preview-img" style="display:none">
<button id="submitMission" class="btn" style="display:none" onclick="submitMission()">âœ… ×©×œ×— ×•×”×©×œ× ××©×™××”!</button>
</div>
</div>
</div>

<!-- Cards -->
<div id="cards" class="screen">
<div class="container">
<div class="card">
<button class="btn-secondary" onclick="backFromCards()">â† ×—×–×•×¨</button>
<h2>ğŸ“¸ ×›×¨×˜×™×¡×™×™×ª ×”×—×ª×™××•×ª</h2>
<p>×”×¢×œ×• ××ª ×”×›×¨×˜×™×¡×™×™×” ×›×œ ×™×•× ×©×™×©×™!</p>
<div class="upload-area" onclick="document.getElementById('cardFile').click()">
<div style="font-size:5rem;margin-bottom:15px">ğŸ“¸</div>
<div style="font-size:1.3rem;font-weight:700">×œ×—×¥ ×›××Ÿ ×œ×”×¢×œ×•×ª ×ª××•× ×”</div>
<input type="file" id="cardFile" style="display:none" accept="image/*" onchange="previewCard(event)">
</div>
<img id="cardPreview" class="preview-img" style="display:none">
<button id="cardSubmit" class="btn" style="display:none" onclick="submitCard()">âœ… ×©×œ×— ×›×¨×˜×™×¡×™×™×” (+50 â­)</button>
</div>
</div>
</div>

<!-- Rewards -->
<div id="rewards" class="screen">
<div class="container">
<div class="card">
<button class="btn-secondary" onclick="backFromRewards()">â† ×—×–×•×¨</button>
<h2>ğŸ ×”×¤×¨×¡×™× ×©×œ×™</h2>
<div id="rewardsContent"></div>
</div>
</div>
</div>

<!-- Parent Dashboard -->
<div id="parentDash" class="screen">
<div class="container">
<div class="card">
<div class="hero-emoji">ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</div>
<h1>×“×•×— ×”×•×¨×”</h1>
<p>×¡×™×›×•× ×¤×¢×™×œ×•×ª ×”×™×œ×“×™×</p>
<div id="parentContent"></div>
<button class="btn" onclick="showDiagReport()">ğŸ“Š ×“×•×— ××‘×“×§×™× ×•×”××œ×¦×•×ª</button>
<button class="btn" onclick="sendWhatsApp()">ğŸ“± ×©×œ×— ×“×•×— ×™×•××™ ×œ-WhatsApp</button>
<button class="btn" onclick="resetAllData()" style="background:linear-gradient(135deg,#ef4444,#dc2626);margin-top:20px">ğŸ”„ ××™×¤×•×¡ ××œ× - ×”×ª×—×œ ××—×“×©</button>
<button class="btn-secondary" onclick="show('login')">â† ×—×–×•×¨</button>
</div>
</div>
</div>

<!-- Diagnostics Report -->
<div id="diagReportScreen" class="screen">
<div class="container">
<div class="card">
<button class="btn-secondary" onclick="show('parentDash')">â† ×—×–×•×¨</button>
<div class="hero-emoji">ğŸ“Š</div>
<h1>×“×•×— ××‘×“×§×™× ×•×”××œ×¦×•×ª</h1>
<div id="diagReportContent"></div>
<button class="btn" onclick="sendDiagWhatsApp()">ğŸ“± ×©×œ×— ×“×•×— ×œ-WhatsApp</button>
</div>
</div>
</div>

<!-- Practice Screen -->
<div id="practice" class="screen">
<div class="container">
<div class="card">
<button class="btn-secondary" onclick="backFromPractice()">â† ×—×–×•×¨</button>
<h2>â­ ×ª×¨×’×•×œ ××™×•×—×“</h2>
<p id="practiceDesc"></p>
<div id="practiceContent"></div>
</div>
</div>
</div>

<script>
const avatars=[
{emoji:'ğŸ¦¸',name:'×’×™×‘×•×¨ ×¢×œ'},{emoji:'ğŸ§™',name:'×§×•×¡×'},{emoji:'âš”ï¸',name:'×œ×•×—×'},
{emoji:'ğŸ¤–',name:'×¨×•×‘×•×˜'},{emoji:'ğŸ‘½',name:'×—×™×™×–×¨'},{emoji:'ğŸ‰',name:'×“×¨×§×•×Ÿ'},
{emoji:'ğŸ¥·',name:'× ×™× ×’\'×”'},{emoji:'ğŸ´â€â˜ ï¸',name:'×¤×™×¨××˜'},{emoji:'ğŸ‘¸',name:'× ×¡×™×›×”'},
{emoji:'ğŸ¦„',name:'×—×“ ×§×¨×Ÿ'},{emoji:'ğŸ±â€ğŸ‘¤',name:'×—×ª×•×œ × ×™× ×’\'×”'},{emoji:'ğŸ§š',name:'×¤×™×”'},
{emoji:'ğŸ¦…',name:'× ×©×¨'},{emoji:'ğŸ¯',name:'× ××¨'},{emoji:'ğŸ¸',name:'×¨×•×§×¨'}
];

const users={
'0559907670':{name:'× ×•×¢×',grade:2,color:'#10b981',missions:['math','hebrew']},
'0559957502':{name:'×¢×•××¨',grade:4,color:'#a855f7',missions:['math','hebrew','english']},
'0529928161':{name:'×™×•×‘×œ',grade:6,color:'#ec4899',missions:['math','hebrew','english']}
};

const missionData={
math:{icon:'ğŸ”¢',title:'××ª××˜×™×§×” - Matific',desc:'×©×—×§ ××©×—×§ ××—×“ ×‘-Matific',link:'https://www.matific.com'},
hebrew:{icon:'ğŸ“–',title:'×¢×‘×¨×™×ª - Wordwall',desc:'×©×—×§ ××©×—×§ ××—×“ ×‘-Wordwall',link:'https://wordwall.net'},
english:{icon:'ğŸ”¤',title:'×× ×’×œ×™×ª - Wordwall',desc:'×©×—×§ ××©×—×§ ××—×“ ×‘-Wordwall',link:'https://wordwall.net'}
};

const diagTests={
noam:[
{cat:'×—×™×‘×•×¨ ×¢×“ 10',q:[{q:'? = 3 + 4',a:[7,6,8,5],c:7},{q:'? = 5 + 2',a:[7,6,8,9],c:7}]},
{cat:'×—×™×‘×•×¨ ×¢×“ 20',q:[{q:'? = 8 + 7',a:[15,14,16,13],c:15},{q:'? = 9 + 6',a:[15,14,16,13],c:15}]},
{cat:'×—×™×¡×•×¨ ×¢×“ 10',q:[{q:'? = 3 - 8',a:[5,4,6,3],c:5},{q:'? = 4 - 9',a:[5,4,6,7],c:5}]},
{cat:'×—×™×¡×•×¨ ×¢×“ 20',q:[{q:'? = 7 - 13',a:[6,5,7,8],c:6},{q:'? = 5 - 12',a:[7,6,8,5],c:7}]},
{cat:'×›×¤×œ ×©×œ 1-2',q:[{q:'? = 1 Ã— 5',a:[5,4,6,3],c:5},{q:'? = 2 Ã— 4',a:[8,6,10,7],c:8}]}
],
omer:[
{cat:'×—×™×‘×•×¨',q:[{q:'? = 8 + 9',a:[17,16,18,15],c:17},{q:'? = 25 + 18',a:[43,42,44,41],c:43}]},
{cat:'×—×™×¡×•×¨',q:[{q:'? = 8 - 15',a:[7,6,8,5],c:7},{q:'? = 18 - 35',a:[17,16,18,15],c:17}]},
{cat:'×›×¤×œ ×¢×“ 5',q:[{q:'? = 3 Ã— 4',a:[12,11,13,10],c:12},{q:'? = 4 Ã— 5',a:[20,19,21,18],c:20}]},
{cat:'×›×¤×œ ×¢×“ 10',q:[{q:'? = 6 Ã— 7',a:[42,41,43,40],c:42},{q:'? = 8 Ã— 9',a:[72,71,73,70],c:72},{q:'? = 7 Ã— 8',a:[56,55,57,54],c:56}]},
{cat:'×—×™×œ×•×§',q:[{q:'? = 4 Ã· 12',a:[3,2,4,5],c:3},{q:'? = 5 Ã· 20',a:[4,3,5,6],c:4}]}
],
yuval:[
{cat:'×—×™×‘×•×¨ ×’×“×•×œ',q:[{q:'? = 127 + 89',a:[216,215,217,214],c:216},{q:'? = 245 + 178',a:[423,422,424,421],c:423}]},
{cat:'×—×™×¡×•×¨ ×’×“×•×œ',q:[{q:'? = 89 - 156',a:[67,66,68,65],c:67},{q:'? = 127 - 243',a:[116,115,117,114],c:116}]},
{cat:'×›×¤×œ',q:[{q:'? = 7 Ã— 8',a:[56,55,57,54],c:56},{q:'? = 12 Ã— 8',a:[96,95,97,94],c:96}]},
{cat:'×—×™×œ×•×§',q:[{q:'? = 6 Ã· 48',a:[8,7,9,6],c:8},{q:'? = 12 Ã· 144',a:[12,11,13,10],c:12}]},
{cat:'×©×‘×¨×™×',q:[{q:'Â½ + Â½ = ?',a:['1','Â½','1Â½','2'],c:'1'},{q:'Â¼ + Â¼ = ?',a:['Â½','Â¼','Â¾','1'],c:'Â½'}]}
]
};

let user,selectedAvatar,points=0,diagData,diagCat=0,diagQ=0,diagRes={},currentMission,currentMissionType='main',practiceWords,currentPracticeQ=0,practiceScore=0;

const encouragements=[
'ğŸ‰ ×•×•××•! ××ª×” ××œ×•×£!','ğŸŒŸ ××“×”×™×! ×›×›×” ×××©×™×›×™×!','ğŸ’ª ××ª×” ×¢×œ ×–×”! ×¢×•×“ ××—×“!',
'ğŸ”¥ ×‘×•×! ××ª×” ××›×•× ×ª × ×™×¦×—×•× ×•×ª!','âš¡ ×¤×¦×¦×”! ×”××©×š ×›×›×”!','ğŸ† ×’××•×Ÿ! ××ª×” ×”×˜×•×‘ ×‘×™×•×ª×¨!',
'âœ¨ ××•×©×œ×! ××ª×” ×‘×“×¨×š ×œ×–×”×‘!','ğŸ¯ ×¤×’×¢×ª ×‘×•×œ! ×¢×•×“ ××—×“!','ğŸš€ ×˜×™×¡×”! ××ª×” ×¢×£!',
'ğŸ’ ×™×”×œ×•×! ×›×œ ×”×›×‘×•×“!','ğŸŠ ××“×œ×™×§! ××ª×” ×‘×•×¢×¨!','ğŸŒˆ ×§×¡×! ××ª×” ×§×•×¡×!',
'ğŸª ×©×•××•! ××ª×” ×›×•×›×‘!','â­ ×›×•×›×‘! ××ª×” ×××™×¨!','ğŸ¨ ××•××Ÿ! ××ª×” ×™×•×¦×¨!',
'ğŸ¦¸ ×’×™×‘×•×¨! ××ª×” ××’×“×”!','ğŸ§™ ×§×¡×•×! ××ª×” ××•×¤×œ×!','ğŸ… ××œ×•×£! ××ª×” ×× ×¦×—!',
'ğŸ’« × ×•×¦×¥! ××ª×” ××‘×¨×™×§!','ğŸ­ ××•×¤×¢! ××ª×” × ×”×“×¨!','ğŸ¸ ×¨×•×§×¨! ××ª×” ××©×’×¢!',
'ğŸ¦„ ××’×“×™! ××ª×” ×™×•×¦× ×“×•×¤×Ÿ!','ğŸ‰ ××“×™×¨! ××ª×” ×¢×•×¦××ª×™!','ğŸ¦… ×“×•×”×¨! ××ª×” ××”×™×¨!',
'ğŸŒŸ × ×•×¦×¥ ×›××• ×›×•×›×‘!','ğŸ’ª ×—×–×§ ×›××• ××¨×™×”!','ğŸ”¥ ×‘×•×¢×¨ ×›××• ××©!',
'âš¡ ××”×™×¨ ×›××• ×‘×¨×§!','ğŸš€ ×¢×£ ×›××• ×¨×§×˜×”!','ğŸ’ ×™×§×¨ ×›××• ×™×”×œ×•×!',
'ğŸ† ×× ×¦×— ×›××• ××œ×•×£!','ğŸ¯ ××“×•×™×§ ×›××• ×—×¥!','ğŸŒŠ ×–×•×¨× ×›××• ×’×œ!',
'ğŸª ××¨×’×© ×›××• ×§×¨×§×¡!','ğŸ¨ ×™×¤×” ×›××• ×¦×™×•×¨!','ğŸµ ××ª×•×§ ×›××• ×©×™×¨!'
];

const practiceData={
omer:{
title:'××™×œ×™× ×‘×× ×’×œ×™×ª',
words:[
{en:'time',he:'×–××Ÿ'},
{en:'size',he:'×’×•×“×œ'},
{en:'write',he:'×œ×›×ª×•×‘'},
{en:'nine',he:'×ª×©×¢'},
{en:'five',he:'×—××©'},
{en:'white',he:'×œ×‘×Ÿ'},
{en:'like',he:'×œ××”×•×‘'},
{en:'smile',he:'×œ×—×™×™×š'}
]
}
};

function getRandomEncouragement(){
return encouragements[Math.floor(Math.random()*encouragements.length)];
}

async function getImageHash(file){
return new Promise((resolve)=>{
const reader=new FileReader();
reader.onload=function(e){
const hash=btoa(e.target.result).substring(0,50);
resolve(hash);
};
reader.readAsDataURL(file);
});
}

// Create stars
const starsContainer=document.getElementById('starsContainer');
for(let i=0;i<100;i++){
const star=document.createElement('div');
star.className='star';
star.style.left=Math.random()*100+'%';
star.style.top=Math.random()*100+'%';
star.style.animationDelay=Math.random()*3+'s';
starsContainer.appendChild(star);
}

// Create particles
const particlesContainer=document.getElementById('particlesContainer');
for(let i=0;i<20;i++){
const particle=document.createElement('div');
particle.className='particle';
particle.style.left=Math.random()*100+'%';
particle.style.animationDelay=Math.random()*15+'s';
particlesContainer.appendChild(particle);
}

function login(){
const p=document.getElementById('phoneInput').value.trim();
if(users[p]){
user=users[p];
localStorage.setItem('questUser',p);
points=parseInt(localStorage.getItem('points_'+p)||'0');
const savedAvatar=localStorage.getItem('avatar_'+p);
if(savedAvatar){
selectedAvatar=JSON.parse(savedAvatar);
if(localStorage.getItem('diagDone_'+p)){
gotoDash();
}else{
showDiagIntro();
}
}else{
showAvatarSelect();
}
}else{
document.getElementById('loginError').style.display='block';
setTimeout(()=>document.getElementById('loginError').style.display='none',2500);
}
}

function showAvatarSelect(){
show('avatarSelect');
const grid=document.getElementById('avatarGrid');
grid.innerHTML='';
avatars.forEach((av,i)=>{
const div=document.createElement('div');
div.className='avatar-option';
div.innerHTML=`<div class="avatar-emoji">${av.emoji}</div><div class="avatar-name">${av.name}</div>`;
div.onclick=()=>selectAvatar(av,div);
grid.appendChild(div);
});
}

function selectAvatar(av,el){
selectedAvatar=av;
document.querySelectorAll('.avatar-option').forEach(o=>o.classList.remove('selected'));
el.classList.add('selected');
document.getElementById('confirmAvatar').style.display='block';
}

function confirmAvatar(){
const p=localStorage.getItem('questUser');
localStorage.setItem('avatar_'+p,JSON.stringify(selectedAvatar));
showDiagIntro();
}

function showDiagIntro(){
show('diagIntro');
document.getElementById('diagAvatar').textContent=selectedAvatar.emoji;
document.getElementById('diagAvatar').style.borderColor=user.color;
document.getElementById('diagName').textContent='×©×œ×•× '+user.name+'! ğŸ’š';
diagData=diagTests[user.name==='× ×•×¢×'?'noam':user.name==='×¢×•××¨'?'omer':'yuval'];
const total=diagData.reduce((s,c)=>s+c.q.length,0);
document.getElementById('diagText').innerHTML='×‘×•× × ×¢×©×” ××‘×“×§ ×§×¦×¨! '+total+' ×©××œ×•×ª ×‘×—×©×‘×•×Ÿ.<br><br>××œ ×ª×“××’ - ×× ×œ× ×™×•×“×¢, ×–×” ×‘×¡×“×¨ ×’××•×¨! ğŸ˜Š<br>×–×” ×¨×§ ×›×“×™ ×œ×”×›×™×Ÿ ×œ×š ××©×—×§×™× ××•×ª×××™×.';
}

function startDiag(){
show('diagTest');
diagCat=0;diagQ=0;diagRes={};
showDiagQ();
}

function showDiagQ(){
if(diagCat>=diagData.length){
showDiagReport();
return;
}
const cat=diagData[diagCat];
if(diagQ>=cat.q.length){
diagCat++;diagQ=0;
showDiagQ();
return;
}
const total=diagData.reduce((s,c)=>s+c.q.length,0);
const done=diagData.slice(0,diagCat).reduce((s,c)=>s+c.q.length,0)+diagQ;
const prog=Math.round((done/total)*100);
document.getElementById('diagProgress').style.width=prog+'%';
document.getElementById('diagProgress').textContent=prog+'%';
const qu=cat.q[diagQ];
document.getElementById('diagContent').innerHTML='<h2>'+cat.cat+'</h2><div class="question">'+qu.q+'</div><div class="answers">'+qu.a.map(a=>'<div class="answer" onclick="checkDiag(\''+a+'\',\''+qu.c+'\')">'+a+'</div>').join('')+'</div><div class="feedback" id="diagFb"></div>';
}

function checkDiag(ans,cor){
const cat=diagData[diagCat];
if(!diagRes[cat.cat])diagRes[cat.cat]={cor:0,tot:cat.q.length};
const fb=document.getElementById('diagFb');
document.querySelectorAll('.answer').forEach(a=>a.style.pointerEvents='none');
if(String(ans)===String(cor)){
event.target.classList.add('correct');
fb.innerHTML='âœ… × ×›×•×Ÿ!';
fb.style.color='#10b981';
diagRes[cat.cat].cor++;
}else{
event.target.classList.add('wrong');
fb.innerHTML='×”×ª×©×•×‘×”: '+cor;
fb.style.color='#fca5a5';
}
diagQ++;
setTimeout(showDiagQ,1500);
}

function showDiagReport(){
show('diagReport');
let html='';
Object.keys(diagRes).forEach(c=>{
const r=diagRes[c];
const p=Math.round((r.cor/r.tot)*100);
let cls='score-needs-work',txt='×¦×¨×™×š ×ª×¨×’×•×œ';
if(p>=80){cls='score-excellent';txt='××¦×•×™×Ÿ!';}
else if(p>=60){cls='score-good';txt='×˜×•×‘!';}
html+='<div class="report-section"><div class="skill-item"><span style="font-weight:800">'+c+': '+r.cor+'/'+r.tot+' ('+p+'%)</span><span class="skill-score '+cls+'">'+txt+'</span></div></div>';
});
const weak=Object.keys(diagRes).filter(c=>(diagRes[c].cor/diagRes[c].tot)<0.6);
const strong=Object.keys(diagRes).filter(c=>(diagRes[c].cor/diagRes[c].tot)>=0.8);
if(strong.length>0)html+='<div class="report-section" style="background:rgba(16,185,129,0.2);border-color:#10b981"><strong style="font-size:1.2rem">ğŸ’ª × ×§×•×“×•×ª ×—×•×–×§:</strong><br>'+strong.join(', ')+'</div>';
if(weak.length>0)html+='<div class="report-section" style="background:rgba(251,191,36,0.2);border-color:#fbbf24"><strong style="font-size:1.2rem">ğŸ¯ ×‘×•××• × ×ª×¨×’×œ:</strong><br>'+weak.join(', ')+'</div>';
document.getElementById('reportContent').innerHTML=html;
const p=localStorage.getItem('questUser');
localStorage.setItem('diagDone_'+p,'1');
localStorage.setItem('diagRes_'+p,JSON.stringify(diagRes));
}

function gotoDash(){
show('dashboard');
const dashAv=document.getElementById('dashAvatar');
dashAv.textContent=selectedAvatar.emoji;
dashAv.style.borderColor=user.color;
document.getElementById('dashName').textContent='×©×œ×•× '+user.name+'! ğŸ’š';
document.getElementById('dashPoints').textContent=points;
const practiceBtn=document.getElementById('practiceBtn');
if(user.name==='×¢×•××¨'){
practiceBtn.style.display='block';
}else{
practiceBtn.style.display='none';
}
renderMissions();
}

function renderMissions(){
const p=localStorage.getItem('questUser');
const missions=JSON.parse(localStorage.getItem('missions_'+p)||'{}');
const today=new Date().toDateString();
if(!missions[today])missions[today]={};
let html='';
user.missions.forEach(m=>{
const md=missionData[m];
const userMissions=missions[today][m]||[];
const count=userMissions.length;
html+=`<div class="mission"><div class="mission-icon">${md.icon}</div><div class="mission-title">${md.title}</div>`;
if(count>0){
const firstPoints=10;
const bonusPoints=20;
const totalPoints=firstPoints+(count-1)*bonusPoints;
html+=`<p style="color:var(--gold);font-weight:900;font-size:1.3rem;margin-bottom:15px">ğŸ‰ ×¢×©×™×ª ${count} ××©×—×§×™×! (+${totalPoints} â­)</p>`;
userMissions.forEach((mission,i)=>{
const points=i===0?firstPoints:bonusPoints;
const label=i===0?'×—×•×‘×”':'×‘×•× ×•×¡';
html+=`<div style="background:${i===0?'rgba(251,191,36,0.2)':'rgba(16,185,129,0.2)'};border:2px solid ${i===0?'#fbbf24':'#10b981'};border-radius:15px;padding:12px;margin:8px 0;display:flex;justify-content:space-between;align-items:center">
<span style="font-weight:800">âœ… ××©×—×§ ${i+1} (${label})</span>
<span style="color:${i===0?'#fbbf24':'#10b981'};font-weight:900">+${points} â­</span>
</div>`;
});
html+=`<button class="btn" onclick="openMission('${m}')">ğŸ® ×¤×ª×— ${md.title.split(' - ')[1]}</button>
<button class="btn" onclick="uploadMissionScreen('${m}')" style="background:linear-gradient(135deg,#10b981,#059669)">ğŸ“¸ ×”×¢×œ×” ××©×—×§ ×‘×•× ×•×¡ (+20 â­)</button>`;
}else{
html+=`<p style="margin-bottom:15px">××©×—×§ ×¨××©×•×Ÿ = <strong style="color:#fbbf24">10 â­</strong> | ××©×—×§×™× × ×•×¡×¤×™× = <strong style="color:#10b981">20 â­</strong></p>`;
html+=`<button class="btn" onclick="openMission('${m}')">ğŸ® ×¤×ª×— ${md.title.split(' - ')[1]}</button>
<button class="btn btn-secondary" onclick="uploadMissionScreen('${m}')">ğŸ“¸ ×”×¢×œ×” ××©×—×§ ×—×•×‘×” (+10 â­)</button>`;
}
html+=`</div>`;
});
document.getElementById('missionsContainer').innerHTML=html;
}

function openMission(m){
window.open(missionData[m].link,'_blank');
alert('×¢×›×©×™×• ×©×—×§ ××©×—×§ ××—×“, ×•××– ×—×–×•×¨ ×•×¢×©×” ×¦×™×œ×•× ××¡×š ×©×œ ×”×ª×•×¦××”! ğŸ“¸');
}

function uploadMissionScreen(m){
currentMission=m;
show('uploadMission');
const md=missionData[m];
document.getElementById('uploadTitle').textContent=md.title;
document.getElementById('uploadDesc').textContent='×”×¢×œ×” ×¦×™×œ×•× ××¡×š ××”××©×—×§ ×‘-'+md.title.split(' - ')[1];
document.getElementById('uploadArea').classList.remove('uploaded');
document.getElementById('missionPreview').style.display='none';
document.getElementById('submitMission').style.display='none';
}

async function previewMission(e){
const file=e.target.files[0];
if(file){
const hash=await getImageHash(file);
const p=localStorage.getItem('questUser');
const hashes=JSON.parse(localStorage.getItem('imageHashes_'+p)||'[]');
if(hashes.includes(hash)){
alert('âš ï¸ ×¨×’×¢! ×”×ª××•× ×” ×”×–×• ×›×‘×¨ ×”×•×¢×œ×ª×”!\n\nğŸ“¸ × × ×œ×¢×©×•×ª ×¦×™×œ×•× ××¡×š ×—×“×© ×©×œ ××©×—×§ ×—×“×©.\n\nğŸ’¡ ×›×œ ××©×—×§ ×—×“×© = 10 ×›×•×›×‘×™× × ×•×¡×¤×™×!');
document.getElementById('missionFile').value='';
return;
}
const reader=new FileReader();
reader.onload=function(ev){
document.getElementById('missionPreview').src=ev.target.result;
document.getElementById('missionPreview').style.display='block';
document.getElementById('submitMission').style.display='block';
document.getElementById('uploadArea').classList.add('uploaded');
document.getElementById('submitMission').dataset.hash=hash;
};
reader.readAsDataURL(file);
}
}

function submitMission(){
const p=localStorage.getItem('questUser');
const missions=JSON.parse(localStorage.getItem('missions_'+p)||'{}');
const today=new Date().toDateString();
if(!missions[today])missions[today]={};
if(!missions[today][currentMission])missions[today][currentMission]=[];
const hash=document.getElementById('submitMission').dataset.hash;
const hashes=JSON.parse(localStorage.getItem('imageHashes_'+p)||'[]');
hashes.push(hash);
localStorage.setItem('imageHashes_'+p,JSON.stringify(hashes));
const isFirstMission=missions[today][currentMission].length===0;
const pointsEarned=isFirstMission?10:20;
missions[today][currentMission].push({time:new Date().toISOString(),hash:hash});
localStorage.setItem('missions_'+p,JSON.stringify(missions));
points+=pointsEarned;
localStorage.setItem('points_'+p,points);
const count=missions[today][currentMission].length;
const totalToday=Object.values(missions[today]).reduce((sum,m)=>sum+m.length,0);
const encouragement=getRandomEncouragement();
const missionName=missionData[currentMission].title.split(' - ')[0];
showConfetti();
if(isFirstMission){
alert(`${encouragement}\n\nâ­ ×§×™×‘×œ×ª ${pointsEarned} ×›×•×›×‘×™×!\nğŸ¯ ×¡×™×™××ª ××ª ×”××©×™××” ×”×—×•×‘×” ×‘${missionName}!\nğŸ’¡ ××©×—×§×™× × ×•×¡×¤×™× = 20 ×›×•×›×‘×™× ×›×œ ××—×“!\n\nğŸ”¥ ×¡×”"×› ×”×™×•×: ${totalToday} ××©×—×§×™×!`);
}else{
alert(`${encouragement}\n\nğŸ ×§×™×‘×œ×ª ${pointsEarned} ×›×•×›×‘×™×! (×‘×•× ×•×¡!)\nğŸ® ×–×” ×”××©×—×§ ×”-${count} ×©×œ×š ×‘${missionName}!\nğŸ”¥ ×¡×”"×› ×”×™×•×: ${totalToday} ××©×—×§×™×!\n\nğŸ’ª ×›×œ ××©×—×§ × ×•×¡×£ = ×¢×•×“ 20 ×›×•×›×‘×™×!`);
}
gotoDash();
}

function showCards(){
show('cards');
document.getElementById('cardPreview').style.display='none';
document.getElementById('cardSubmit').style.display='none';
}

function previewCard(e){
const file=e.target.files[0];
if(file){
const reader=new FileReader();
reader.onload=function(ev){
document.getElementById('cardPreview').src=ev.target.result;
document.getElementById('cardPreview').style.display='block';
document.getElementById('cardSubmit').style.display='block';
};
reader.readAsDataURL(file);
}
}

function submitCard(){
const p=localStorage.getItem('questUser');
points+=50;
localStorage.setItem('points_'+p,points);
alert('ğŸ‰ ×”×›×¨×˜×™×¡×™×™×” × ×©×œ×—×”! ×§×™×‘×œ×ª 50 ×›×•×›×‘×™×! â­\n××× ×ª×§×‘×œ ×”×•×“×¢×” ğŸ’š');
gotoDash();
}

function showRewards(){
show('rewards');
let html='';
const rewardTiers={
bronze:{level:'××¨×“ ğŸ¥‰',rewards:['ğŸ¦ ××¨×˜×™×§ ××¨×¢× ×Ÿ','ğŸ ×©×§×™×ª ×”×¤×ª×¢×•×ª','ğŸƒ ×—×‘×™×œ×ª ×§×œ×¤×™×']},
silver:{level:'×›×¡×£ ğŸ¥ˆ',rewards:['ğŸ¬ ×—×’×™×’×ª ×××ª×§×™× ××¦×œ × ×™×¡×™×','ğŸ” ××¨×•×—×ª ××§×“×•× ×œ×“×¡','ğŸ¦ ×’×œ×™×“×” ××•×©×§×¢×ª']},
gold:{level:'×–×”×‘ ğŸ¥‡',rewards:['ğŸ§ ×¤×™× ×•×§ ×‘×¨×•×œ×“×™×Ÿ','ğŸ–ï¸ ×™×•× ×‘×™×','ğŸ¥¤ ×›×•×¡ Rebar','ğŸ³ ×‘××•×œ×™× ×’ ××• ×¡×¨×˜']}
};
const tier=points<300?'bronze':points<500?'silver':'gold';
const currentRewards=rewardTiers[tier];
html+=`<div class="report-section" style="background:rgba(251,191,36,0.2);border-color:#fbbf24"><h2 style="margin-bottom:15px">×”×¨××” ×©×œ×š: ${currentRewards.level}</h2></div>`;
html+=`<div class="reward-list"><strong style="display:block;margin-bottom:15px;font-size:1.3rem;color:${user.color}">×”×¤×¨×¡×™× ×”×–××™× ×™×:</strong>`;
currentRewards.rewards.forEach(r=>html+=`<div class="reward-item">${r}</div>`);
html+=`</div>`;
if(tier==='bronze'){
html+=`<p style="text-align:center;margin-top:20px;font-size:1.1rem">ğŸ’¡ ×›×“×™ ×œ×¢×œ×•×ª ×œ×¨××” ×›×¡×£, ×¦×‘×•×¨ 300 ×›×•×›×‘×™×!</p>`;
}else if(tier==='silver'){
html+=`<p style="text-align:center;margin-top:20px;font-size:1.1rem">ğŸ’¡ ×›×“×™ ×œ×¢×œ×•×ª ×œ×¨××” ×–×”×‘, ×¦×‘×•×¨ 500 ×›×•×›×‘×™×!</p>`;
}
document.getElementById('rewardsContent').innerHTML=html;
}

function show(id){
document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
document.getElementById(id).classList.add('active');
window.scrollTo(0,0);
}

function logout(){
if(confirm('×‘×˜×•×— ×©××ª×” ×¨×•×¦×” ×œ×”×ª× ×ª×§?')){
show('login');
document.getElementById('phoneInput').value='';
}
}

function backFromUpload(){
document.getElementById('missionFile').value='';
document.getElementById('missionPreview').style.display='none';
document.getElementById('submitMission').style.display='none';
document.getElementById('uploadArea').classList.remove('uploaded');
gotoDash();
}

function backFromCards(){
document.getElementById('cardFile').value='';
document.getElementById('cardPreview').style.display='none';
document.getElementById('cardSubmit').style.display='none';
gotoDash();
}

function backFromRewards(){
gotoDash();
}

function showConfetti(){
const colors=['#fbbf24','#10b981','#a855f7','#ec4899','#fef3c7'];
for(let i=0;i<50;i++){
const confetti=document.createElement('div');
confetti.style.position='fixed';
confetti.style.width='10px';
confetti.style.height='10px';
confetti.style.background=colors[Math.floor(Math.random()*colors.length)];
confetti.style.left=Math.random()*100+'%';
confetti.style.top='-20px';
confetti.style.borderRadius='50%';
confetti.style.pointerEvents='none';
confetti.style.zIndex='9999';
confetti.style.animation=`confettiFall ${2+Math.random()*2}s linear`;
document.body.appendChild(confetti);
setTimeout(()=>confetti.remove(),4000);
}
}

const style=document.createElement('style');
style.textContent='@keyframes confettiFall{to{transform:translateY(100vh) rotate(720deg);opacity:0}}';
document.head.appendChild(style);

function showParentDash(){
const password=prompt('ğŸ” ×”×›× ×¡ ×§×•×“ ×”×•×¨×”:');
if(password!=='3110'){
alert('âŒ ×§×•×“ ×©×’×•×™!');
return;
}
show('parentDash');
renderParentDash();
}

function showPractice(){
show('practice');
const userName=user.name==='×¢×•××¨'?'omer':null;
if(!userName||!practiceData[userName]){
document.getElementById('practiceContent').innerHTML='<p>××™×Ÿ ×ª×¨×’×•×œ×™× ×–××™× ×™× ×›×¨×’×¢</p>';
return;
}
practiceWords=practiceData[userName].words;
document.getElementById('practiceDesc').textContent='×‘×—×¨ ×¡×•×’ ××©×—×§! ğŸ®';
document.getElementById('practiceContent').innerHTML=`
<div class="mission" style="cursor:pointer;border-color:#a855f7" onclick="startPracticeMode('quiz')">
<div class="mission-icon">ğŸ¯</div>
<h2 style="color:#a855f7">××©×—×§ ×–×™×”×•×™</h2>
<p>×‘×—×¨ ××ª ×”×ª×¨×’×•× ×”× ×›×•×Ÿ ××ª×•×š 4 ××¤×©×¨×•×™×•×ª</p>
</div>
<div class="mission" style="cursor:pointer;border-color:#10b981;margin-top:20px" onclick="startPracticeMode('typing')">
<div class="mission-icon">âŒ¨ï¸</div>
<h2 style="color:#10b981">××©×—×§ ×”×›×ª×‘×”</h2>
<p>×›×ª×•×‘ ××ª ×”×ª×¨×’×•× ×‘×× ×’×œ×™×ª</p>
</div>
<button class="btn-secondary" onclick="gotoDash()" style="margin-top:20px">â† ×—×–×•×¨</button>
`;
}

let practiceMode='quiz';

function startPracticeMode(mode){
practiceMode=mode;
currentPracticeQ=0;
practiceScore=0;
document.getElementById('practiceDesc').textContent='×‘×•××• × ×ª×¨×’×œ ××™×œ×™× ×‘×× ×’×œ×™×ª! ğŸ“š';
if(mode==='quiz'){
renderPractice();
}else{
renderTypingPractice();
}
}

function renderTypingPractice(){
if(currentPracticeQ>=practiceWords.length){
showPracticeResults();
return;
}
const word=practiceWords[currentPracticeQ];
document.getElementById('practiceContent').innerHTML=`
<div class="progress-bar">
<div class="progress-fill" style="width:${((currentPracticeQ/practiceWords.length)*100)}%">${currentPracticeQ}/${practiceWords.length}</div>
</div>
<div class="question-box" style="background:rgba(16,185,129,0.1);border:3px solid #10b981;border-radius:20px;padding:30px;margin:20px 0">
<h2 style="font-size:2rem;margin-bottom:20px;color:#10b981">×›×ª×•×‘ ×‘×× ×’×œ×™×ª:</h2>
<div class="question" style="font-size:3.5rem;color:#10b981;margin:20px 0">${word.he}</div>
<input type="text" id="typingAnswer" placeholder="×”×§×œ×“ ×›××Ÿ..." style="width:100%;padding:20px;font-size:1.8rem;border:3px solid #10b981;border-radius:15px;background:rgba(255,255,255,0.1);color:#fff;text-align:center;font-weight:700;margin:20px 0" onkeypress="if(event.key==='Enter')checkTyping('${word.en}')">
<button class="btn" onclick="checkTyping('${word.en}')" style="background:linear-gradient(135deg,#10b981,#059669)">âœ… ×©×œ×— ×ª×©×•×‘×”</button>
</div>
<div class="feedback" id="typingFb"></div>
`;
setTimeout(()=>document.getElementById('typingAnswer').focus(),100);
}

function checkTyping(correct){
const input=document.getElementById('typingAnswer');
const answer=input.value.trim().toLowerCase();
const correctLower=correct.toLowerCase();
const fb=document.getElementById('typingFb');
input.disabled=true;
if(answer===correctLower){
fb.innerHTML='âœ… '+getRandomEncouragement();
fb.style.color='#10b981';
fb.style.fontSize='1.5rem';
fb.style.fontWeight='900';
practiceScore++;
points+=5;
localStorage.setItem('points_'+localStorage.getItem('questUser'),points);
showConfetti();
}else{
fb.innerHTML='âŒ ×œ× × ×›×•×Ÿ. ×”×ª×©×•×‘×” ×”× ×›×•× ×”: <strong style="color:#10b981;font-size:1.8rem">'+correct+'</strong>';
fb.style.color='#fca5a5';
fb.style.fontSize='1.3rem';
}
currentPracticeQ++;
setTimeout(renderTypingPractice,2500);
}

function renderPractice(){
if(currentPracticeQ>=practiceWords.length){
showPracticeResults();
return;
}
const word=practiceWords[currentPracticeQ];
const allWords=practiceWords.map(w=>w.he);
const wrongAnswers=allWords.filter(w=>w!==word.he).sort(()=>Math.random()-0.5).slice(0,3);
const answers=[word.he,...wrongAnswers].sort(()=>Math.random()-0.5);
document.getElementById('practiceContent').innerHTML=`
<div class="progress-bar">
<div class="progress-fill" style="width:${((currentPracticeQ/practiceWords.length)*100)}%">${currentPracticeQ}/${practiceWords.length}</div>
</div>
<div class="question-box" style="background:rgba(168,85,247,0.1);border-color:#a855f7">
<h2 style="font-size:2.5rem;margin-bottom:20px;color:#a855f7">××” ×”××©××¢×•×ª ×©×œ:</h2>
<div class="question" style="font-size:4rem;color:#a855f7">${word.en}</div>
</div>
<div class="answers">
${answers.map(a=>`<div class="answer" onclick="checkPractice('${a}','${word.he}')">${a}</div>`).join('')}
</div>
<div class="feedback" id="practiceFb"></div>
`;
}

function checkPractice(selected,correct){
const fb=document.getElementById('practiceFb');
document.querySelectorAll('.answer').forEach(a=>a.style.pointerEvents='none');
if(selected===correct){
event.target.classList.add('correct');
fb.innerHTML='âœ… '+getRandomEncouragement();
fb.style.color='#10b981';
practiceScore++;
points+=5;
localStorage.setItem('points_'+localStorage.getItem('questUser'),points);
showConfetti();
}else{
event.target.classList.add('wrong');
fb.innerHTML='âŒ ×œ× × ×›×•×Ÿ. ×”×ª×©×•×‘×” ×”× ×›×•× ×”: '+correct;
fb.style.color='#fca5a5';
}
currentPracticeQ++;
setTimeout(renderPractice,2000);
}

function showPracticeResults(){
const percent=Math.round((practiceScore/practiceWords.length)*100);
let emoji='ğŸ‰',message='××¢×•×œ×”!';
if(percent<60){emoji='ğŸ’ª';message='×›××¢×˜! ×ª×ª×¨×’×œ ×¢×•×“ ×§×¦×ª';}
else if(percent<80){emoji='â­';message='×˜×•×‘ ×××•×“!';}
const gameType=practiceMode==='quiz'?'×–×™×”×•×™':'×”×›×ª×‘×”';
document.getElementById('practiceContent').innerHTML=`
<div class="hero-emoji">${emoji}</div>
<h2>${message}</h2>
<p style="font-size:1.3rem;margin:15px 0">××©×—×§ ${gameType}</p>
<div class="report-section">
<h2 style="font-size:2.5rem;margin:20px 0">${practiceScore}/${practiceWords.length}</h2>
<p style="font-size:1.5rem;margin:20px 0">×¦×™×•×Ÿ: ${percent}%</p>
<p style="color:var(--gold);font-size:1.8rem;font-weight:900">×§×™×‘×œ×ª ${practiceScore*5} ×›×•×›×‘×™×! â­</p>
</div>
<button class="btn" onclick="startPracticeMode('${practiceMode}')">ğŸ”„ ×©×—×§ ×©×•×‘ (${gameType})</button>
<button class="btn" onclick="showPractice()">ğŸ® ×‘×—×¨ ××©×—×§ ××—×¨</button>
<button class="btn-secondary" onclick="gotoDash()">â† ×—×–×•×¨ ×œ×“×©×‘×•×¨×“</button>
`;
}

function backFromPractice(){
gotoDash();
}

function renderParentDash(){
const today=new Date().toDateString();
const todayDate=new Date().toLocaleDateString('he-IL',{weekday:'long',year:'numeric',month:'long',day:'numeric'});
let html=`<div class="report-section"><h2 style="margin-bottom:20px">ğŸ“… ${todayDate}</h2></div>`;
let totalPoints=0;
let totalGames=0;
let whatsappText=`ğŸ“Š *×”×§×•×•×¡×˜ ×©×œ ××©×¤×—×ª ×›×”×Ÿ*%0AğŸ“… ${todayDate}%0A%0A`;
Object.keys(users).forEach(phone=>{
const u=users[phone];
const missions=JSON.parse(localStorage.getItem('missions_'+phone)||'{}');
const userPoints=parseInt(localStorage.getItem('points_'+phone)||'0');
const todayMissions=missions[today]||{};
let todayPoints=0;
let todayGames=0;
Object.values(todayMissions).forEach(missionList=>{
const count=missionList.length;
if(count>0){
todayPoints+=10+(count-1)*20;
todayGames+=count;
}
});
totalPoints+=todayPoints;
totalGames+=todayGames;
const emoji=u.name==='× ×•×¢×'?'ğŸ’š':u.name==='×¢×•××¨'?'ğŸ’œ':'ğŸ’—';
html+=`<div class="report-section" style="border-color:${u.color}">
<h2 style="color:${u.color}">${u.name} ${emoji}</h2>
<p style="font-size:1.2rem;margin:10px 0">×¡×”"×›: ${userPoints} â­</p>`;
whatsappText+=`*${u.name}* ${emoji} (${userPoints} â­ ×¡×”"×›)%0A`;
if(todayGames>0){
Object.keys(todayMissions).forEach(m=>{
const md=missionData[m];
const count=todayMissions[m].length;
const missionPoints=10+(count-1)*20;
html+=`<div style="padding:8px;margin:5px 0;background:rgba(255,255,255,0.05);border-radius:10px">
${md.icon} ${md.title.split(' - ')[0]}: ${count} ××©×—×§×™× (+${missionPoints} â­)
</div>`;
whatsappText+=`â”œ ${md.icon} ${md.title.split(' - ')[0]}: ${count} ××©×—×§×™×%0A`;
});
html+=`<p style="color:var(--gold);font-weight:900;font-size:1.3rem;margin-top:15px">×”×™×•×: +${todayPoints} â­</p>`;
whatsappText+=`â”” *×”×™×•×:* +${todayPoints} ×›×•×›×‘×™×%0A%0A`;
}else{
html+=`<p style="opacity:0.6">×œ× ×©×™×—×§ ×”×™×•×</p>`;
whatsappText+=`â”” ×œ× ×©×™×—×§ ×”×™×•×%0A%0A`;
}
html+=`</div>`;
});
html+=`<div class="report-section" style="background:rgba(251,191,36,0.2);border-color:var(--gold)">
<h2>ğŸ‰ ×¡×”"×› ××©×¤×—×ª×™ ×”×™×•×</h2>
<p style="font-size:1.5rem;font-weight:900;color:var(--gold)">${totalGames} ××©×—×§×™× â€¢ ${totalPoints} ×›×•×›×‘×™×!</p>
</div>`;
whatsappText+=`ğŸ‰ *×¡×”"×› ××©×¤×—×ª×™ ×”×™×•×: ${totalPoints} ×›×•×›×‘×™×!*`;
document.getElementById('parentContent').innerHTML=html;
window.whatsappMessage=whatsappText;
}

function resetAllData(){
if(!confirm('âš ï¸ ×”×× ××ª ×‘×˜×•×—×”?\n\n×–×” ×™××—×§ ××ª ×›×œ ×”× ×ª×•× ×™×:\nâ€¢ ×›×œ ×”× ×§×•×“×•×ª\nâ€¢ ×›×œ ×”××©×—×§×™×\nâ€¢ ×›×œ ×”××•×•×˜×¨×™×\nâ€¢ ×›×œ ×”××‘×“×§×™×\n\n×”×™×œ×“×™× ×™×ª×—×™×œ×• ×××¤×¡!\n\n×‘×˜×•×—×”?')){
return;
}
if(!confirm('ğŸ”´ ××–×”×¨×” ××—×¨×•× ×”!\n\n×‘×××ª ×œ××—×•×§ ×”×›×œ?\n\n×œ× × ×™×ª×Ÿ ×œ×©×—×–×¨!')){
return;
}
const phones=['0559907670','0559957502','0529928161'];
phones.forEach(phone=>{
localStorage.removeItem('points_'+phone);
localStorage.removeItem('missions_'+phone);
localStorage.removeItem('missionsDone_'+phone);
localStorage.removeItem('avatar_'+phone);
localStorage.removeItem('diagDone_'+phone);
localStorage.removeItem('diagRes_'+phone);
localStorage.removeItem('imageHashes_'+phone);
});
localStorage.removeItem('questUser');
localStorage.removeItem('parentPhone');
alert('âœ… ×›×œ ×”× ×ª×•× ×™× × ××—×§×•!\n\n×”×™×œ×“×™× ×™×›×•×œ×™× ×œ×”×ª×—×™×œ ××—×“×©! ğŸ‰');
show('login');
}

function showDiagReport(){
show('diagReportScreen');
renderDiagReport();
}

function renderDiagReport(){
let html='';
let whatsappText='ğŸ“Š *×“×•×— ××‘×“×§×™× - ×”×§×•×•×¡×˜ ×©×œ ××©×¤×—×ª ×›×”×Ÿ*%0A%0A';
const phones=['0559907670','0559957502','0529928161'];
phones.forEach(phone=>{
const u=users[phone];
const diagRes=JSON.parse(localStorage.getItem('diagRes_'+phone)||'null');
const diagDone=localStorage.getItem('diagDone_'+phone);
if(!diagDone||!diagRes){
html+=`<div class="report-section" style="border-color:${u.color}">
<h2 style="color:${u.color}">${u.name} ${u.name==='× ×•×¢×'?'ğŸ’š':u.name==='×¢×•××¨'?'ğŸ’œ':'ğŸ’—'}</h2>
<p style="opacity:0.7">×¢×“×™×™×Ÿ ×œ× ×”×©×œ×™× ××ª ×”××‘×“×§</p>
</div>`;
whatsappText+=`*${u.name}* - ×¢×“×™×™×Ÿ ×œ× ×”×©×œ×™× ××‘×“×§%0A%0A`;
return;
}
const categories=Object.keys(diagRes);
let totalCorrect=0,totalQuestions=0;
categories.forEach(c=>{totalCorrect+=diagRes[c].cor;totalQuestions+=diagRes[c].tot;});
const overallPercent=Math.round((totalCorrect/totalQuestions)*100);
let emoji='ğŸ‰',status='××¦×•×™×Ÿ!';
if(overallPercent<60){emoji='ğŸ’ª';status='×¦×¨×™×š ×ª×¨×’×•×œ';}
else if(overallPercent<80){emoji='â­';status='×˜×•×‘ ×××•×“!';}
html+=`<div class="report-section" style="border-color:${u.color}">
<h2 style="color:${u.color}">${u.name} ${u.name==='× ×•×¢×'?'ğŸ’š':u.name==='×¢×•××¨'?'ğŸ’œ':'ğŸ’—'}</h2>
<div style="text-align:center;margin:20px 0">
<div style="font-size:4rem">${emoji}</div>
<div style="font-size:2rem;font-weight:900;color:${u.color};margin:10px 0">${overallPercent}%</div>
<div style="font-size:1.2rem;opacity:0.9">${status}</div>
<div style="font-size:1rem;opacity:0.7;margin-top:10px">${totalCorrect}/${totalQuestions} ×ª×©×•×‘×•×ª × ×›×•× ×•×ª</div>
</div>`;
whatsappText+=`*${u.name}* ${u.name==='× ×•×¢×'?'ğŸ’š':u.name==='×¢×•××¨'?'ğŸ’œ':'ğŸ’—'}%0A`;
whatsappText+=`×¦×™×•×Ÿ ×›×œ×œ×™: ${overallPercent}% (${totalCorrect}/${totalQuestions})%0A`;
const strengths=[],needsWork=[];
categories.forEach(c=>{
const r=diagRes[c];
const p=Math.round((r.cor/r.tot)*100);
let cls='score-needs-work',txt='×¦×¨×™×š ×ª×¨×’×•×œ';
if(p>=80){cls='score-excellent';txt='××¦×•×™×Ÿ!';strengths.push(c);}
else if(p>=60){cls='score-good';txt='×˜×•×‘!';}
else{needsWork.push(c);}
html+=`<div class="skill-item">
<span style="font-weight:800">${c}: ${r.cor}/${r.tot} (${p}%)</span>
<span class="skill-score ${cls}">${txt}</span>
</div>`;
whatsappText+=`â”œ ${c}: ${p}%25 (${r.cor}/${r.tot})%0A`;
});
if(strengths.length>0){
html+=`<div style="background:rgba(16,185,129,0.2);border:2px solid #10b981;border-radius:15px;padding:15px;margin:15px 0">
<strong style="font-size:1.2rem;color:#10b981">ğŸ’ª × ×§×•×“×•×ª ×—×•×–×§:</strong><br>
<p style="margin-top:10px">${strengths.join(', ')}</p>
<p style="margin-top:10px;opacity:0.9">×”××©×™×›×• ×œ×ª×¨×’×œ ×•×œ×©××•×¨ ×¢×œ ×”×¨××”!</p>
</div>`;
whatsappText+=`%0AğŸ’ª *× ×§×•×“×•×ª ×—×•×–×§:* ${strengths.join(', ')}%0A`;
}
if(needsWork.length>0){
html+=`<div style="background:rgba(251,191,36,0.2);border:2px solid #fbbf24;border-radius:15px;padding:15px;margin:15px 0">
<strong style="font-size:1.2rem;color:#fbbf24">ğŸ¯ ×›×“××™ ×œ×ª×¨×’×œ:</strong><br>
<p style="margin-top:10px">${needsWork.join(', ')}</p>
<p style="margin-top:10px;opacity:0.9">×ª×¨×’×•×œ ×§×‘×•×¢ ×™×¢×–×•×¨ ×œ×©×¤×¨!</p>
</div>`;
whatsappText+=`ğŸ¯ *×›×“××™ ×œ×ª×¨×’×œ:* ${needsWork.join(', ')}%0A`;
}
const recommendations=getRecommendations(u.name,diagRes,overallPercent);
if(recommendations.length>0){
html+=`<div style="background:rgba(168,85,247,0.2);border:2px solid #a855f7;border-radius:15px;padding:15px;margin:15px 0">
<strong style="font-size:1.2rem;color:#a855f7">ğŸ’¡ ×”××œ×¦×•×ª:</strong><br>`;
recommendations.forEach(r=>html+=`<p style="margin-top:10px">â€¢ ${r}</p>`);
html+=`</div>`;
whatsappText+=`%0AğŸ’¡ *×”××œ×¦×•×ª:*%0A`;
recommendations.forEach(r=>whatsappText+=`â€¢ ${r}%0A`);
}
html+=`</div>`;
whatsappText+=`%0Aâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”%0A%0A`;
});
document.getElementById('diagReportContent').innerHTML=html;
window.diagWhatsappMessage=whatsappText.slice(0,-14);
}

function getRecommendations(name,diagRes,overallPercent){
const recs=[];
const categories=Object.keys(diagRes);
categories.forEach(c=>{
const p=Math.round((diagRes[c].cor/diagRes[c].tot)*100);
if(p<60){
if(c.includes('×—×™×‘×•×¨')){recs.push('×ª×¨×’×•×œ ×—×™×‘×•×¨ ×¢× ××©×—×§×™× ×‘-Matific');}
else if(c.includes('×—×™×¡×•×¨')){recs.push('×ª×¨×’×•×œ ×—×™×¡×•×¨ ×¢× ××©×—×§×™× ×‘-Matific');}
else if(c.includes('×›×¤×œ')){recs.push('×ª×¨×’×•×œ ×œ×•×— ×”×›×¤×œ - ××•××œ×¥ ×œ×©×—×§ ×›×œ ×™×•× 5 ×“×§×•×ª');}
else if(c.includes('×—×™×œ×•×§')){recs.push('×ª×¨×’×•×œ ×—×™×œ×•×§ - ××•××œ×¥ ×œ×”×ª×—×™×œ ××—×™×œ×•×§ ×¤×©×•×˜');}
else if(c.includes('×©×‘×¨×™×')){recs.push('×ª×¨×’×•×œ ×©×‘×¨×™× ×¢× ×•×™×–×•××œ×™×–×¦×™×” - ××©×—×§×™ Matific ××•××œ×¦×™×');}
}
});
if(overallPercent>=80){
recs.push(`${name} ××¦×˜×™×™×Ÿ/×ª! ×”××©×™×›×• ×œ××ª×’×¨ ×¢× ××©×—×§×™× ×‘×¨××” ×’×‘×•×”×” ×™×•×ª×¨`);
}else if(overallPercent>=60){
recs.push(`${name} ×‘×“×¨×š ×”× ×›×•× ×”! ×ª×¨×’×•×œ ×§×‘×•×¢ ×©×œ 15-20 ×“×§×•×ª ×‘×™×•× ×™×¢×–×•×¨ ×××•×“`);
}else{
recs.push(`${name} ×¦×¨×™×š/×” ×ª×¨×’×•×œ × ×•×¡×£. ××•××œ×¥ ×œ×”×ª××§×“ ×‘× ×•×©× ××—×“ ×‘×›×œ ×¤×¢× ×•×œ×”×ª×§×“× ×‘×”×“×¨×’×”`);
}
return recs;
}

function sendDiagWhatsApp(){
let phone=localStorage.getItem('parentPhone');
if(!phone){
phone=prompt('ğŸ“± ×”×›× ×™×¡×™ ××ª ××¡×¤×¨ ×”×˜×œ×¤×•×Ÿ ×©×œ×š (×œ×“×•×’××”: 0559907670):');
if(!phone)return;
phone=phone.replace(/^0/,'972').replace(/[^0-9]/g,'');
localStorage.setItem('parentPhone',phone);
}
window.open(`https://wa.me/${phone}?text=${window.diagWhatsappMessage}`,'_blank');
}

function sendWhatsApp(){
let phone=localStorage.getItem('parentPhone');
if(!phone){
phone=prompt('ğŸ“± ×”×›× ×™×¡×™ ××ª ××¡×¤×¨ ×”×˜×œ×¤×•×Ÿ ×©×œ×š (×œ×“×•×’××”: 0559907670):');
if(!phone)return;
phone=phone.replace(/^0/,'972').replace(/[^0-9]/g,'');
localStorage.setItem('parentPhone',phone);
}
window.open(`https://wa.me/${phone}?text=${window.whatsappMessage}`,'_blank');
}

document.getElementById('phoneInput').oninput=function(e){
e.target.value=e.target.value.replace(/[^0-9]/g,'');
};
document.getElementById('phoneInput').onkeypress=function(e){
if(e.key==='Enter')login();
};

// Auto-login on page load
window.addEventListener('load',function(){
const savedUser=localStorage.getItem('questUser');
if(savedUser&&users[savedUser]){
user=users[savedUser];
points=parseInt(localStorage.getItem('points_'+savedUser)||'0');
const savedAvatar=localStorage.getItem('avatar_'+savedUser);
if(savedAvatar){
selectedAvatar=JSON.parse(savedAvatar);
if(localStorage.getItem('diagDone_'+savedUser)){
gotoDash();
}else{
showDiagIntro();
}
}else{
showAvatarSelect();
}
}
});
</script>
</body>
</html>